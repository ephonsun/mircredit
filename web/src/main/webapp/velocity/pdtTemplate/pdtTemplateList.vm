#parse("/velocity/taglibs.vm")<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />    <title>产品类型模板</title>        <link type="text/css" rel="stylesheet" href="${ctx}/css/basic.css" />    <link type="text/css" rel="stylesheet" href="${ctx}/css/public.css" />    <style type="text/css">    	span.ml { margin-left: -1px; }    </style></head><body>	<div style="margin:10px;">		<table class="htmltbl">			<tbody>				<tr>					<td class="field" width="8%">						<label>产品类型：</label>					</td>					<td width="17%">						<div class="ui-div-text" width="150px">							<input type="text" class="text" id="templateName" name="template.templateName" maxLength="20"/>						</div>					</td>					<td>					</td>				</tr>			</tbody>		</table>		<div class="search-bar">			<span class="fl bold">				所有产品类型模板(<label class="green" id="queryCount">$!page.totalRowsAmount</label>)			</span>			<input type="button" class="ui-input-btn" id="clearTemp" value="清空" />			<input type="button" class="ui-input-btn" id="searchTemp" value="搜索" />		</div>				<div class="action-bar">			<span class="ui-span-btn fl" onclick="addTab('insert');">				<label>新建模板</label>			</span>			<span class="ui-span-btn fr" id="refreshForm">				<label>刷新</label>			</span>		</div>		<div id="grid">           #parse("/velocity/pdtTemplate/pdtTemplateListTable.vm")        </div>	</div></body>#scriptLink("core")#scriptLink("page")<script type="text/javascript" src="${ctx}/js/system/b.base.js"></script><script type="text/javascript" src="${ctx}/js/controls/jquery.select-v1.0.js"></script><script type="text/javascript" src="${ctx}/js/system/b.date.js"></script><script type="text/javascript" src="${ctx}/js/controls/jquery.table-v1.0.js"></script><script type="text/javascript" src="${ctx}/js/banger/banger.tabs-v1.interface.js"></script><script type="text/javascript">	var oldPostJson={};	$(function(){		$('table.datatbl').table();		$('select').select(); 				$('#searchTemp').click(function(){			searchType();		});		$('#clearTemp').click(function(){			clearTemp();		});		$('#refreshForm').click(function(){			refreshForm();		});		getQueryJson();	});		//分页跳转	function gotoPage(page)	{		oldPostJson['search']='search';		goto(page,"showPdtTemplateList.html?random="+Math.random()*1000000,oldPostJson,function(html){refreshGrid('grid',html);});	}	//刷新Grid	function refreshGrid(gridId,html)	{		var elem=$(html);		var gridDiv = $("#"+gridId);		gridDiv[0].innerHTML="";		gridDiv.append(elem);		var total = $('#total').val();		if(total!=null){			$('#queryCount').text(total);		}		else {			$('#queryCount').text("0");		}		$('table.datatbl').table();	}	//刷新	function refreshForm(){		oldPostJson['search']='search';		goto(null,"showPdtTemplateList.html?random="+Math.random()*1000000,oldPostJson,function(html){refreshGrid('grid',html);});	}	//搜索	function searchType(){		var postJson=getQueryJson();		oldPostJson['search']='search';		oldPostJson = postJson;		jQuery.post("showPdtTemplateList.html?random="+Math.random()*1000000,postJson,					function(html){refreshGrid('grid',html);});	}	function getQueryJson(){    	var postJson = {};		postJson['template.templateName']=jQuery.trim($('#templateName').val());		oldPostJson = postJson;		return postJson;	}		//清空	function clearTemp(){		$('#templateName').val("");	}		//打开页卡	function addTab(flag,id,name){		if(flag=='feild'){			tab.add({id: "template_field"+id , pid: GetId(), title: "模板字段-"+name, url: "../productTempField/showTemplateFieldList.html?templateId="+id+"&random="+Math.random(), lock: false});		}		if(flag=='insert'){			tab.add({id: "product_temp", pid: GetId(), title: "新建产品类型模板", url: "../productTemplate/savePdtTemplate.html", lock: false});		}		if(flag=='update'){			tab.add({id: "product_temp"+id, pid: GetId(), title: "编辑产品类型模板-"+name, url: "../productTemplate/updatePdtTemplate.html?flag=1&template.templateId="+id+"&random="+Math.random(), lock: false});		}			}		//上移下移	function moveData(id,flag){		jQuery.post('/productTemplate/moveTemplate.html',{'template.templateId':id,'saveFlag':flag},					function(){refreshForm()});	}		//停用启用	function activeTemp(id,state){		//var str;		//if(state==0) str='启用';		//else if(state==1) str='停用';		//if(confirm("您确定要"+str+"该模板吗？")){    		jQuery.post('activePdtTemplate.html',{'template.templateId':id,'flag':state},        				function(data){    						if(data !=""){								banger.page.showMessageBox(data);    						}else{            					refreshForm();    						}            			});		//}	}		//删除	function delTemp(id,name){		if(confirm("确定要删除产品类型“"+name+"”吗？")){    		jQuery.post('delPdtTemplate.html',{'template.templateId':id},        				function(data){    						if(data !=""){								banger.page.showMessageBox(data);    						}else{            					refreshForm();    						}            			});		}	}	</script></html>